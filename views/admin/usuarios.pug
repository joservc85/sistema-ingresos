extends ../layout/index

block contenido
    // Contenedor principal para el panel
    div(class="py-10 max-w-7xl mx-auto")
        //- Títulos originales, se mantienen en esta vista
        h1(class="text-4xl my-10 font-extrabold text-center text-gray-800")
            | Sistema 
            span(class="font-normal") Ingresos      
        h2(class="text-center text-2xl font-bold text-fuchsia-600")= pagina

        // Mostramos los errores de validación si existen
        if errores
            div(class="max-w-md mx-auto my-6")
                each error in errores
                    div(class="flex items-center bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-2" role="alert")
                        p(class="font-bold")= error.msg

       
        // Contenedor de la tabla con sombra y bordes redondeados
        div(class="mb-8 bg-white p-6 rounded-lg shadow-md flex flex-wrap gap-4 items-end")

            div(class="flex justify-end mb-6")
                a(href="/admin/usuarios/crear" class="flex items-center gap-2 bg-gradient-to-r from-fuchsia-500 to-purple-600 hover:from-fuchsia-600 hover:to-purple-700 text-white font-bold py-2 px-4 rounded-md transition-all")
                    i(class="fas fa-plus")
                    span Crear Nuevo Usuario

            table(class="min-w-full leading-normal")
                // Encabezado de la tabla
                thead
                    tr
                        // NUEVO: Reemplazamos text-left por text-center
                        th(class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider") Nombre
                        th(class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider") Usuario
                        th(class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider") Rol
                        th(class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider") Acciones

                // Cuerpo de la tabla
                tbody
                    // Hacemos un bucle sobre la variable 'usuarios'
                    each usuario in usuarios
                        tr
                            // NUEVO: Añadimos text-center para centrar el contenido
                            td(class="px-5 py-5 border-b border-gray-200 bg-white text-sm text-center")
                                p(class="text-gray-900 whitespace-no-wrap")= usuario.nombre
                            
                            // NUEVO: Añadimos text-center
                            td(class="px-5 py-5 border-b border-gray-200 bg-white text-sm text-center")
                                p(class="text-gray-900 whitespace-no-wrap")= usuario.username
                            
                            // NUEVO: Añadimos text-center
                            td(class="px-5 py-5 border-b border-gray-200 bg-white text-sm text-center")
                                - const roleName = usuario.role ? usuario.role.nombre : 'Sin Rol'
                                - const isAdmin = usuario.role && usuario.role.nombre === 'Admin'
                                - const roleClass = isAdmin ? 'bg-green-200 text-green-800' : 'bg-blue-200 text-blue-800'

                                if usuario.role
                                    span(class=`px-3 py-1 text-xs font-semibold rounded-full ${roleClass}`)= roleName
                                else
                                    // Estilo para cuando no hay rol asignado
                                    span(class="px-3 py-1 text-xs font-semibold rounded-full bg-yellow-200 text-yellow-800")= roleName

                            
                            // NUEVO: Celda de acciones con botones estilizados y centrados usando Flexbox
                            td(class="px-5 py-5 border-b border-gray-200 bg-white text-sm")
                                div(class="flex items-center justify-center gap-x-4")
                                    a(href=`/admin/usuarios/editar/${usuario.id}` class="bg-amber-500 hover:bg-amber-600 text-white px-4 py-1 rounded-md font-semibold text-xs transition-colors") Editar

                                    form(method="POST" action=`/admin/usuarios/eliminar/${usuario.id}` class="inline")
                                        input(type="hidden" name="_csrf" value=csrfToken)
                                        // Botón Eliminar estilizado
                                        button(type="submit" class="bg-red-600 hover:bg-red-700 text-white px-4 py-1 rounded-md font-semibold text-xs transition-colors cursor-pointer") Eliminar

block scripts
    script(src="/js/usuario.js")