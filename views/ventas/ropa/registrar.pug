extends ../../layout/index

block contenido
    div(class="py-10")
        h1(class="text-3xl md:text-4xl my-10 font-extrabold text-center") Registrar 
            span(class="font-normal") Venta de Ropa

        div(class="bg-white shadow-lg py-8 px-4 rounded-lg max-w-4xl mx-auto")
            div(class="flex justify-start mb-6")
                a(href="/ventas/ropa/historial" class="flex items-center gap-2 text-gray-600 hover:text-gray-800 transition-colors")
                    i(class="fas fa-arrow-left")
                    span(class="font-bold") Regresar al Inventario

            //- Muestra de errores
            if errores
                div(class="mb-6")
                    each error in errores
                        p(class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-2 font-bold")= error.msg

            form(method="POST")
                input(type="hidden" name="_csrf" value=csrfToken)

                //- SECCIÓN DE CLIENTE (OPCIONAL)
                fieldset(class="border border-gray-300 p-4 rounded-md")
                    legend(class="px-2 text-lg font-semibold text-gray-700") Datos de la Venta
                    div
                        label(for="clienteId" class="block text-sm font-medium text-gray-700") Cliente (Opcional)
                        select#clienteId(name="clienteId" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-fuchsia-500 focus:border-fuchsia-500")
                            option(value="") -- Consumidor Final --
                            each cliente in clientes
                                if cliente.tipo === 'Ropa' || cliente.tipo === 'Ambos'
                                    option(value=cliente.id)= `${cliente.nombre} ${cliente.apellidos}`

                //- SECCIÓN DE ARTÍCULOS
                fieldset(class="mt-6 border border-gray-300 p-4 rounded-md")
                    legend(class="px-2 text-lg font-semibold text-gray-700") Artículos Vendidos
                    
                    div#detalle-venta-container(class="space-y-4 mt-2")
                        //- Las filas se insertarán aquí con JS
                    
                    button(type="button" id="agregar-detalle" class="mt-4 flex items-center gap-2 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md cursor-pointer")
                        i(class="fas fa-plus")
                        span Añadir Artículo

                //- Botón de Guardar                        
                div(class="mt-8 pt-6 border-t border-gray-200 flex justify-end gap-4")
                    a(href="/ventas/ropa/historial" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-md transition-colors") Cancelar
                    input(type="submit", value="Registrar Venta", class="bg-fuchsia-600 hover:bg-fuchsia-700 text-white font-bold py-2 px-6 rounded-md cursor-pointer transition-all shadow-md")

    //- PLANTILLA PARA UNA FILA DE DETALLE (Oculta)
    div(id="plantilla-detalle" class="hidden")
        div(class="detalle-item grid grid-cols-12 gap-x-3 items-end p-2 border rounded-md bg-gray-50")
            //- Artículo (Select)
            div(class="col-span-12 md:col-span-8")
                label(class="text-xs text-gray-600") Artículo
                select(name="articuloId[]" class="w-full text-sm border-gray-300 rounded-md articulo-select")
                    option(value="") -- Seleccione un artículo --
                    each articulo in articulos
                        option(value=articulo.id data-stock=articulo.stock_actual data-precio=articulo.precio_venta) #{articulo.nombre} - (#{articulo.marca || 'N/A'}) - (#{articulo.talla || 'N/A'}) - (Stock: #{articulo.stock_actual})
            
            //- Cantidad
            div(class="col-span-8 md:col-span-3")
                label(class="text-xs text-gray-600") Cantidad
                input(type="number" name="cantidad[]" value="1" min="1" class="w-full text-sm border-gray-300 rounded-md px-2")
            
            //- Botón Eliminar
            div(class="col-span-4 md:col-span-1 flex justify-end items-center")
                button(type="button" class="eliminar-detalle text-red-500 hover:text-red-700 p-2 cursor-pointer")
                    i(class="fas fa-trash-alt")

block scripts
    //- Script para manejar la lógica de este formulario
    script(src="/js/ventaRopa.js")
