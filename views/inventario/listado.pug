extends ../layout/index

block contenido
    div(class="py-10 max-w-7xl mx-auto")
        h1(class="text-4xl my-10 font-extrabold text-center text-gray-800")
            | Inventario&nbsp;
            span(class="font-normal") General
        h2(class="text-center text-2xl font-bold text-fuchsia-600")= pagina

        div(class="mt-6 flex justify-start")
            a(href="/articulos/leer" class="flex items-center gap-2 text-gray-600 hover:text-gray-800 transition-colors")
                i(class="fas fa-arrow-left")
                span Regresar a Artículos

        if !articulos || articulos.length === 0
            div(class="text-center mt-10 bg-white shadow-md p-6 rounded-lg")
                p(class="text-xl text-gray-600") No hay artículos registrados en el inventario.
        else
            //- Panel de Filtros Responsivo
            div(class="mt-8 bg-slate-50 border border-slate-200 p-4 rounded-lg shadow-sm mb-8")
                form(method="GET" action="/inventario")
                    div(class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end")
                        //- Filtro por nombre
                        div
                            label(for="nombre" class="block text-sm font-medium text-gray-700 mb-1") Nombre del artículo
                            input#nombre(type="text", name="nombre", value=nombreFiltro || '', placeholder="Buscar por nombre", class="w-full px-3 py-2 border border-gray-300 rounded-md")

                        //- Filtro por categoría
                        div
                            label(for="categoria" class="block text-sm font-medium text-gray-700 mb-1") Categoría
                            select#categoria(name="categoria" class="w-full px-3 py-2 border border-gray-300 rounded-md")
                                option(value="") -- Todas --
                                each categoria in categorias
                                    option(value=categoria.id selected=(categoriaFiltro == categoria.id.toString()))= categoria.nombre_categoria
                        
                        //- Botones de acción
                        div(class="flex flex-col sm:flex-row gap-3")
                            button(type="submit" class="w-full flex-grow bg-fuchsia-500 hover:bg-fuchsia-600 text-white font-bold py-2 px-4 rounded-md") Buscar
                            a(href="/inventario" class="w-full flex-grow flex items-center justify-center gap-2 bg-gray-400 hover:bg-gray-500 text-white font-bold px-4 py-2 rounded-lg")
                                i(class="fas fa-undo")
                                span Limpiar
                    
                    //- Botón de Exportar
                    div(class="mt-4 pt-4 border-t")
                        a(href=`/inventario/exportar?nombre=${nombreFiltro}&categoria=${categoriaFiltro}` class="inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md")
                            i(class="fas fa-file-excel")
                            | Exportar Excel

            //- Tabla Responsiva
            div(class="bg-white shadow-lg rounded-lg overflow-hidden")
                table(class="min-w-full leading-normal text-sm")
                    //- Encabezado de la tabla (oculto en móvil)
                    thead(class="hidden md:table-header-group")
                        tr
                            th(class="px-5 py-3 bg-gray-100 text-left text-xs font-bold text-gray-600 uppercase") Categoría
                            th(class="px-5 py-3 bg-gray-100 text-left text-xs font-bold text-gray-600 uppercase") Nombre
                            th(class="px-5 py-3 bg-gray-100 text-center text-xs font-bold text-gray-600 uppercase") Unidad
                            th(class="px-5 py-3 bg-gray-100 text-center text-xs font-bold text-gray-600 uppercase") Stock Mínimo
                            th(class="px-5 py-3 bg-gray-100 text-center text-xs font-bold text-gray-600 uppercase") Stock Actual
                            th(class="px-5 py-3 bg-gray-100 text-center text-xs font-bold text-gray-600 uppercase") Estado

                    tbody
                        each articulo in articulos
                            //- Cada fila es una tarjeta en móvil
                            tr(class="block md:table-row mb-4 md:mb-0 border md:border-none rounded-lg")
                                td(class="block md:table-cell px-5 py-3 md:py-4 border-b border-gray-200 text-right md:text-left")
                                    span(class="md:hidden float-left font-bold text-gray-600") Categoría:
                                    p(class="text-gray-800 whitespace-no-wrap")= articulo.categoria ? articulo.categoria.nombre_categoria : 'N/A'
                                
                                td(class="block md:table-cell px-5 py-3 md:py-4 border-b border-gray-200 text-right md:text-left")
                                    span(class="md:hidden float-left font-bold text-gray-600") Nombre:
                                    p(class="font-semibold text-gray-900 whitespace-no-wrap")= articulo.nombre_articulo
                                
                                td(class="block md:table-cell px-5 py-3 md:py-4 border-b border-gray-200 text-right md:text-center")
                                    span(class="md:hidden float-left font-bold text-gray-600") Unidad:
                                    p(class="text-gray-700 whitespace-no-wrap")= articulo.unidad ? `${articulo.unidad.nombre} (${articulo.unidad.abreviatura})` : 'N/A'
                                
                                td(class="block md:table-cell px-5 py-3 md:py-4 border-b border-gray-200 text-right md:text-center")
                                    span(class="md:hidden float-left font-bold text-gray-600") Stock Mínimo:
                                    p(class="text-gray-700 whitespace-no-wrap")= articulo.stock_minimo
                                
                                td(class="block md:table-cell px-5 py-3 md:py-4 border-b border-gray-200 text-right md:text-center")
                                    span(class="md:hidden float-left font-bold text-gray-600") Stock Actual:
                                    p(class=`font-bold whitespace-no-wrap ${articulo.stock_actual < articulo.stock_minimo ? 'text-red-600' : 'text-green-600'}`)= articulo.stock_actual
                                
                                td(class="block md:table-cell px-5 py-3 md:py-4 border-b-0 md:border-b border-gray-200 text-right md:text-center")
                                    span(class="md:hidden float-left font-bold text-gray-600") Estado:
                                    span(class=`px-3 py-1 text-xs font-semibold rounded-full ${articulo.stock_actual < articulo.stock_minimo ? 'bg-red-200 text-red-800' : 'bg-green-200 text-green-800'}`)
                                        = articulo.stock_actual < articulo.stock_minimo ? 'Stock Bajo' : 'OK'
            
            //- Paginación (si existe)
            if totalPaginas > 1
                div(class="mt-8")
                    include ../layout/paginacion